# دليل اختبار إصلاح الإدخال السريع للطلاب التمهيديين

## خطوات الاختبار

### 1. اختبار الحفظ الأساسي
1. افتح صفحة الإدخال السريع (`/teacher/quick-entry`)
2. ابحث عن طالب تمهيدي في القائمة
3. أدخل البيانات التالية:
   - رقم الصفحة: مثلاً `1`
   - اختر بعض الأسطر (أو اتركها فارغة لحفظ الصفحة كاملة)
   - التقدير: اختر أي تقدير (مثلاً "ممتاز")
4. اضغط على زر "حفظ الكل"
5. **النتيجة المتوقعة**: رسالة نجاح "تم الحفظ بنجاح"

### 2. اختبار حفظ صفحات متعددة
1. لنفس الطالب، أضف صفحة ثانية بالضغط على زر "+"
2. أدخل رقم صفحة مختلف وتقدير
3. اضغط "حفظ الكل"
4. **النتيجة المتوقعة**: حفظ جميع الصفحات بنجاح

### 3. اختبار السلوك والملاحظات
1. أدخل تقدير السلوك (مثلاً "جيد جداً")
2. أضف ملاحظة في حقل الملاحظات
3. اضغط "حفظ الكل"
4. **النتيجة المتوقعة**: حفظ السلوك والملاحظات مع التسميعات

### 4. اختبار الحضور التلقائي
1. أدخل تسميع لطالب تمهيدي
2. لا تضغط على زر الحضور يدوياً
3. اضغط "حفظ الكل"
4. **النتيجة المتوقعة**: تسجيل الطالب حاضراً تلقائياً

### 5. اختبار تحميل البيانات
1. أدخل بيانات لطالب تمهيدي واحفظها
2. اضغط على زر "تحميل بيانات اليوم"
3. **النتيجة المتوقعة**: ظهور البيانات المحفوظة في الحقول

### 6. اختبار معالجة الأخطاء
افتح Console في المتصفح (F12) وراقب الرسائل:
- إذا ظهرت أخطاء، ستجد تفاصيل واضحة عن المشكلة
- ابحث عن رسائل تبدأ بـ "Error inserting beginner recitations"

## التحقق من قاعدة البيانات

### باستخدام Supabase Dashboard:
1. افتح Supabase Dashboard
2. اذهب إلى Table Editor
3. افتح جدول `student_beginner_recitations`
4. تحقق من وجود السجلات المحفوظة:
   - `student_id`: معرف الطالب
   - `date`: تاريخ اليوم
   - `page_number`: رقم الصفحة
   - `line_numbers`: أرقام الأسطر (أو 1,2,3,4,5,6,7,8,9,10 للصفحة الكاملة)
   - `line_count`: عدد الأسطر
   - `grade`: التقدير

### باستخدام SQL:
```sql
-- عرض جميع تسميعات اليوم للطلاب التمهيديين
SELECT 
  s.name as student_name,
  sbr.page_number,
  sbr.line_numbers,
  sbr.line_count,
  sbr.grade,
  sbr.date
FROM student_beginner_recitations sbr
JOIN students s ON s.id = sbr.student_id
WHERE sbr.date = CURRENT_DATE
ORDER BY s.name, sbr.page_number;
```

## الأخطاء الشائعة وحلولها

### 1. "فشل في حفظ البيانات"
- **السبب**: خطأ في الاتصال بقاعدة البيانات
- **الحل**: تحقق من اتصال الإنترنت وإعدادات Supabase

### 2. "يجب إضافة تقدير التسميع"
- **السبب**: إدخال رقم صفحة بدون تقدير
- **الحل**: أضف تقدير لكل صفحة أو احذف الصفحة الفارغة

### 3. لا تظهر البيانات بعد الحفظ
- **السبب**: قد يكون هناك خطأ في الحفظ
- **الحل**: 
  1. افتح Console (F12)
  2. ابحث عن رسائل الخطأ
  3. تحقق من جدول `student_beginner_recitations` في قاعدة البيانات

### 4. "Error inserting beginner recitations"
- **السبب**: خطأ في بنية البيانات أو صلاحيات قاعدة البيانات
- **الحل**: 
  1. تحقق من Console لرؤية تفاصيل الخطأ
  2. تأكد من أن جدول `student_beginner_recitations` موجود
  3. تحقق من صلاحيات RLS في Supabase

## ملاحظات مهمة
- البيانات تُحفظ تلقائياً في LocalStorage أثناء الإدخال
- عند الضغط على "حفظ الكل"، يتم حفظ البيانات في قاعدة البيانات ومسحها من LocalStorage
- إذا حدث خطأ، لن يتم مسح البيانات من LocalStorage حتى لا تفقدها
- يمكنك الضغط على "إعادة تعيين" لمسح جميع البيانات والبدء من جديد
